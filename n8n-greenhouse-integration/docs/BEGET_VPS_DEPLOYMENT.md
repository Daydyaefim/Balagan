# üöÄ –†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ –Ω–∞ Beget VPS

## –ü–æ–ª–Ω–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –Ω–∞—Å—Ç—Ä–æ–π–∫–µ n8n –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ –Ω–∞ VPS –æ—Ç Beget

---

## üìã –ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è

- ‚úÖ VPS —Å–µ—Ä–≤–µ—Ä –æ—Ç Beget (–ª—é–±–æ–π —Ç–∞—Ä–∏—Ñ)
- ‚úÖ n8n —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω–∞—è —á–µ—Ä–µ–∑ –º–∞—Ä–∫–µ—Ç–ø–ª–µ–π—Å Beget
- ‚úÖ SSH –¥–æ—Å—Ç—É–ø –∫ —Å–µ—Ä–≤–µ—Ä—É
- ‚úÖ –ë–∞–∑–æ–≤—ã–µ –∑–Ω–∞–Ω–∏—è Linux

---

## üéØ –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –Ω–∞ Beget VPS

```
Beget VPS Server
‚îú‚îÄ‚îÄ n8n (—É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞ —á–µ—Ä–µ–∑ –º–∞—Ä–∫–µ—Ç–ø–ª–µ–π—Å)
‚îÇ   ‚îú‚îÄ‚îÄ –ü–æ—Ä—Ç: 5678
‚îÇ   ‚îî‚îÄ‚îÄ Workflows –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ MQTT
‚îú‚îÄ‚îÄ Nginx (–¥–ª—è –≤–µ–±-–¥–∞—à–±–æ—Ä–¥–∞)
‚îÇ   ‚îú‚îÄ‚îÄ –ü–æ—Ä—Ç: 80/443
‚îÇ   ‚îî‚îÄ‚îÄ –°—Ç–∞—Ç–∏—á–µ—Å–∫–∏–µ —Ñ–∞–π–ª—ã –¥–∞—à–±–æ—Ä–¥–∞
‚îú‚îÄ‚îÄ MQTT Client (–≤ n8n)
‚îÇ   ‚îî‚îÄ‚îÄ –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ broker.emqx.io
‚îî‚îÄ‚îÄ –î–∞–Ω–Ω—ã–µ
    ‚îî‚îÄ‚îÄ /home/username/greenhouse-data/
```

---

## üì¶ –®–∞–≥ 1: –£—Å—Ç–∞–Ω–æ–≤–∫–∞ n8n —á–µ—Ä–µ–∑ Beget Marketplace

### 1.1 –ß–µ—Ä–µ–∑ –ø–∞–Ω–µ–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è Beget

1. –í–æ–π–¥–∏—Ç–µ –≤ –ø–∞–Ω–µ–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è Beget
2. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ —Ä–∞–∑–¥–µ–ª **"VPS"** ‚Üí **"Marketplace"**
3. –ù–∞–π–¥–∏—Ç–µ **"n8n"** –≤ —Å–ø–∏—Å–∫–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π
4. –ù–∞–∂–º–∏—Ç–µ **"–£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å"**
5. –î–æ–∂–¥–∏—Ç–µ—Å—å –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è —É—Å—Ç–∞–Ω–æ–≤–∫–∏

### 1.2 –î–æ—Å—Ç—É–ø –∫ n8n

–ü–æ—Å–ª–µ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ n8n –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–Ω–∞ –ø–æ –∞–¥—Ä–µ—Å—É:
```
http://–≤–∞—à-ip:5678
```

–ò–ª–∏ –µ—Å–ª–∏ –Ω–∞—Å—Ç—Ä–æ–µ–Ω –¥–æ–º–µ–Ω:
```
https://n8n.–≤–∞—à-–¥–æ–º–µ–Ω.ru
```

**–í–∞–∂–Ω–æ:** –ó–∞–ø–æ–º–Ω–∏—Ç–µ –ª–æ–≥–∏–Ω –∏ –ø–∞—Ä–æ–ª—å, –∫–æ—Ç–æ—Ä—ã–µ –±—ã–ª–∏ —Å–æ–∑–¥–∞–Ω—ã –ø—Ä–∏ —É—Å—Ç–∞–Ω–æ–≤–∫–µ!

---

## üîê –®–∞–≥ 2: –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –ø–æ SSH

### 2.1 –ü–æ–ª—É—á–µ–Ω–∏–µ SSH –¥–æ—Å—Ç—É–ø–∞

–í –ø–∞–Ω–µ–ª–∏ Beget:
1. **VPS** ‚Üí **–ù–∞—Å—Ç—Ä–æ–π–∫–∏**
2. –ù–∞–π–¥–∏—Ç–µ –¥–∞–Ω–Ω—ã–µ –¥–ª—è SSH:
   - IP –∞–¥—Ä–µ—Å
   - –ü–æ—Ä—Ç SSH (–æ–±—ã—á–Ω–æ 22)
   - –õ–æ–≥–∏–Ω
   - –ü–∞—Ä–æ–ª—å

### 2.2 –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ

**Linux/Mac:**
```bash
ssh username@your-vps-ip -p 22
```

**Windows (PuTTY):**
- Host: `your-vps-ip`
- Port: `22`
- Username: `username`
- Password: `–≤–∞—à_–ø–∞—Ä–æ–ª—å`

---

## üìÇ –®–∞–≥ 3: –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–π –¥–ª—è –¥–∞–Ω–Ω—ã—Ö

```bash
# –ü–æ–¥–∫–ª—é—á–∏—Ç–µ—Å—å –ø–æ SSH
ssh username@your-vps-ip

# –°–æ–∑–¥–∞–π—Ç–µ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é –¥–ª—è –¥–∞–Ω–Ω—ã—Ö —Ç–µ–ø–ª–∏—Ü—ã
mkdir -p ~/greenhouse-data
chmod 755 ~/greenhouse-data

# –°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª—ã –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö
cd ~/greenhouse-data
touch ugagro_readings.json
touch telegram_alert_states.json
touch ugagro_alerts_history.json
touch cleanup_log.json

# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –ø—Ä–∞–≤–∞
chmod 666 *.json

# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—É
ls -la
```

–î–æ–ª–∂–Ω–æ –ø–æ–ª—É—á–∏—Ç—å—Å—è:
```
/home/username/greenhouse-data/
‚îú‚îÄ‚îÄ ugagro_readings.json
‚îú‚îÄ‚îÄ telegram_alert_states.json
‚îú‚îÄ‚îÄ ugagro_alerts_history.json
‚îî‚îÄ‚îÄ cleanup_log.json
```

---

## üîß –®–∞–≥ 4: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è n8n

### 4.1 –ù–∞–π—Ç–∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã–π —Ñ–∞–π–ª n8n

```bash
# –ù–∞–π–¥–∏—Ç–µ –ø—Ä–æ—Ü–µ—Å—Å n8n
ps aux | grep n8n

# –û–±—ã—á–Ω–æ –∫–æ–Ω—Ñ–∏–≥ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤
nano ~/.n8n/.env
```

### 4.2 –î–æ–±–∞–≤–∏—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

–ï—Å–ª–∏ —Ñ–∞–π–ª `.env` –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç, —Å–æ–∑–¥–∞–π—Ç–µ –µ–≥–æ:

```bash
nano ~/.n8n/.env
```

–î–æ–±–∞–≤—å—Ç–µ —Å–ª–µ–¥—É—é—â–∏–µ —Å—Ç—Ä–æ–∫–∏:

```env
# Telegram Bot
TELEGRAM_BOT_TOKEN=–≤–∞—à_—Ç–æ–∫–µ–Ω_–æ—Ç_BotFather
TELEGRAM_CHAT_ID=–≤–∞—à_chat_id

# Timezone
GENERIC_TIMEZONE=Europe/Moscow
TZ=Europe/Moscow

# Data paths
GREENHOUSE_DATA_DIR=/home/username/greenhouse-data
```

**–ó–∞–º–µ–Ω–∏—Ç–µ:**
- `username` –Ω–∞ –≤–∞—à –ª–æ–≥–∏–Ω –≤ —Å–∏—Å—Ç–µ–º–µ
- `–≤–∞—à_—Ç–æ–∫–µ–Ω_–æ—Ç_BotFather` –Ω–∞ —Ä–µ–∞–ª—å–Ω—ã–π —Ç–æ–∫–µ–Ω
- `–≤–∞—à_chat_id` –Ω–∞ –≤–∞—à ID –≤ Telegram

–°–æ—Ö—Ä–∞–Ω–∏—Ç–µ: `Ctrl+O`, `Enter`, `Ctrl+X`

### 4.3 –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å n8n

```bash
# –ù–∞–π–¥–∏—Ç–µ PID –ø—Ä–æ—Ü–µ—Å—Å–∞ n8n
ps aux | grep n8n

# –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ (–∫–æ–º–∞–Ω–¥–∞ –∑–∞–≤–∏—Å–∏—Ç –æ—Ç —Å–ø–æ—Å–æ–±–∞ —É—Å—Ç–∞–Ω–æ–≤–∫–∏)
# –í–∞—Ä–∏–∞–Ω—Ç 1: systemd
sudo systemctl restart n8n

# –í–∞—Ä–∏–∞–Ω—Ç 2: pm2
pm2 restart n8n

# –í–∞—Ä–∏–∞–Ω—Ç 3: –µ—Å–ª–∏ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω —á–µ—Ä–µ–∑ Docker
docker restart n8n
```

---

## üì• –®–∞–≥ 5: –ó–∞–≥—Ä—É–∑–∫–∞ workflows –Ω–∞ —Å–µ—Ä–≤–µ—Ä

### 5.1 –°–∫–∞—á–∞—Ç—å —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –Ω–∞ VPS

```bash
# –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ –¥–æ–º–∞—à–Ω—é—é –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é
cd ~

# –ö–ª–æ–Ω–∏—Ä—É–π—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
git clone https://github.com/Daydyaefim/Balagan.git

# –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ –ø–∞–ø–∫—É —Å –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–µ–π
cd Balagan/n8n-greenhouse-integration

# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –Ω–∞–ª–∏—á–∏–µ workflows
ls -la workflows/
```

### 5.2 –ò–º–ø–æ—Ä—Ç workflows –≤ n8n UI

1. –û—Ç–∫—Ä–æ–π—Ç–µ –±—Ä–∞—É–∑–µ—Ä: `http://–≤–∞—à-ip:5678`
2. –í–æ–π–¥–∏—Ç–µ —Å –ª–æ–≥–∏–Ω–æ–º –∏ –ø–∞—Ä–æ–ª–µ–º
3. –ü–µ—Ä–µ–π–¥–∏—Ç–µ: **Workflows** ‚Üí **Import from File**
4. –ò–º–ø–æ—Ä—Ç–∏—Ä—É–π—Ç–µ –≤—Å–µ 5 workflows:
   - `01-mqtt-data-pipeline.json`
   - `02-critical-alerts-monitor.json`
   - `03-telegram-callback-handler.json`
   - `04-web-dashboard-api.json`
   - `05-data-rotation-cleanup.json`

---

## ‚öôÔ∏è –®–∞–≥ 6: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Credentials –≤ n8n

### 6.1 MQTT Broker

1. –í n8n UI: **Settings** ‚Üí **Credentials** ‚Üí **New**
2. –í—ã–±–µ—Ä–∏—Ç–µ —Ç–∏–ø: **MQTT**
3. –ó–∞–ø–æ–ª–Ω–∏—Ç–µ:
   - **Protocol**: `mqtt`
   - **Host**: `broker.emqx.io`
   - **Port**: `1883`
   - **Username**: (–æ—Å—Ç–∞–≤–∏—Ç—å –ø—É—Å—Ç—ã–º)
   - **Password**: (–æ—Å—Ç–∞–≤–∏—Ç—å –ø—É—Å—Ç—ã–º)
4. –ù–∞–∂–º–∏—Ç–µ **Save**

### 6.2 Telegram Bot API

1. **Settings** ‚Üí **Credentials** ‚Üí **New**
2. –í—ã–±–µ—Ä–∏—Ç–µ —Ç–∏–ø: **Telegram API**
3. –ó–∞–ø–æ–ª–Ω–∏—Ç–µ:
   - **Access Token**: –≤—Å—Ç–∞–≤—å—Ç–µ —Ç–æ–∫–µ–Ω –∏–∑ `.env`
4. –ù–∞–∂–º–∏—Ç–µ **Save**

---

## üîó –®–∞–≥ 7: –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ Credentials –∫ Workflows

–î–ª—è **–∫–∞–∂–¥–æ–≥–æ** –∏–∑ 5 workflows:

1. –û—Ç–∫—Ä–æ–π—Ç–µ workflow
2. –ù–∞–π–¥–∏—Ç–µ –Ω–æ–¥—ã —Å –∏–∫–æ–Ω–∫–æ–π –∫–ª—é—á–∞ (—Ç—Ä–µ–±—É—é—Ç credentials):
   - **MQTT Trigger** / **MQTT** ‚Üí –≤—ã–±–µ—Ä–∏—Ç–µ —Å–æ–∑–¥–∞–Ω–Ω—ã–π MQTT credential
   - **Telegram** / **Telegram Trigger** ‚Üí –≤—ã–±–µ—Ä–∏—Ç–µ Telegram credential
3. **–û–±–Ω–æ–≤–∏—Ç–µ –ø—É—Ç–∏ –∫ —Ñ–∞–π–ª–∞–º** –≤ Code –Ω–æ–¥–∞—Ö:
   - –ó–∞–º–µ–Ω–∏—Ç–µ `/data/` –Ω–∞ `/home/username/greenhouse-data/`
4. –ù–∞–∂–º–∏—Ç–µ **Save**

### –ü—Ä–∏–º–µ—Ä –∏–∑–º–µ–Ω–µ–Ω–∏—è –ø—É—Ç–∏ –≤ Code –Ω–æ–¥–µ:

**–ë—ã–ª–æ:**
```javascript
operation: "read",
filePath: "/data/ugagro_readings.json"
```

**–°—Ç–∞–ª–æ:**
```javascript
operation: "read",
filePath: "/home/username/greenhouse-data/ugagro_readings.json"
```

**–í–ê–ñ–ù–û:** –ó–∞–º–µ–Ω–∏—Ç–µ `username` –Ω–∞ –≤–∞—à —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–∏–π –ª–æ–≥–∏–Ω!

---

## ‚úÖ –®–∞–≥ 8: –ê–∫—Ç–∏–≤–∞—Ü–∏—è Workflows

–î–ª—è –∫–∞–∂–¥–æ–≥–æ workflow:
1. –û—Ç–∫—Ä–æ–π—Ç–µ workflow
2. –ü–µ—Ä–µ–∫–ª—é—á–∏—Ç–µ **Active** (–≤ –ø—Ä–∞–≤–æ–º –≤–µ—Ä—Ö–Ω–µ–º —É–≥–ª—É)
3. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —Å—Ç–∞—Ç—É—Å —Å—Ç–∞–ª –∑–µ–ª–µ–Ω—ã–º

**–ü–æ—Ä—è–¥–æ–∫ –∞–∫—Ç–∏–≤–∞—Ü–∏–∏:**
1. ‚úÖ 01 - MQTT Data Pipeline (–ø–µ—Ä–≤—ã–º!)
2. ‚úÖ 02 - Critical Alerts Monitor
3. ‚úÖ 03 - Telegram Callback Handler
4. ‚úÖ 04 - Web Dashboard API
5. ‚úÖ 05 - Data Rotation & Cleanup

---

## üåê –®–∞–≥ 9: –†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ –í–µ–±-–î–∞—à–±–æ—Ä–¥–∞

### 9.1 –£—Å—Ç–∞–Ω–æ–≤–∫–∞ Nginx (–µ—Å–ª–∏ –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω)

```bash
# –î–ª—è Ubuntu/Debian
sudo apt update
sudo apt install nginx -y

# –î–ª—è CentOS/RHEL
sudo yum install nginx -y

# –ó–∞–ø—É—Å—Ç–∏—Ç—å –∏ –≤–∫–ª—é—á–∏—Ç—å –∞–≤—Ç–æ–∑–∞–≥—Ä—É–∑–∫—É
sudo systemctl start nginx
sudo systemctl enable nginx
```

### 9.2 –ö–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ —Ñ–∞–π–ª–æ–≤ –¥–∞—à–±–æ—Ä–¥–∞

```bash
# –°–æ–∑–¥–∞–π—Ç–µ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é –¥–ª—è –¥–∞—à–±–æ—Ä–¥–∞
sudo mkdir -p /var/www/greenhouse-dashboard

# –°–∫–æ–ø–∏—Ä—É–π—Ç–µ —Ñ–∞–π–ª—ã
sudo cp -r ~/Balagan/n8n-greenhouse-integration/web-dashboard/* /var/www/greenhouse-dashboard/

# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –ø—Ä–∞–≤–∞
sudo chown -R www-data:www-data /var/www/greenhouse-dashboard
sudo chmod -R 755 /var/www/greenhouse-dashboard
```

### 9.3 –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Nginx –∫–æ–Ω—Ñ–∏–≥–∞

```bash
sudo nano /etc/nginx/sites-available/greenhouse
```

–í—Å—Ç–∞–≤—å—Ç–µ —Å–ª–µ–¥—É—é—â—É—é –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é:

```nginx
server {
    listen 80;
    server_name –≤–∞—à-–¥–æ–º–µ–Ω.ru;  # –ó–∞–º–µ–Ω–∏—Ç–µ –Ω–∞ –≤–∞—à –¥–æ–º–µ–Ω –∏–ª–∏ IP

    root /var/www/greenhouse-dashboard;
    index index.html;

    # –õ–æ–≥–∏
    access_log /var/log/nginx/greenhouse_access.log;
    error_log /var/log/nginx/greenhouse_error.log;

    # –ì–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞
    location / {
        try_files $uri $uri/ /index.html;
    }

    # –ü—Ä–æ–∫—Å–∏—Ä–æ–≤–∞–Ω–∏–µ API –∫ n8n
    location /webhook/ {
        proxy_pass http://localhost:5678/webhook/;
        proxy_http_version 1.1;

        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection 'upgrade';
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;

        proxy_connect_timeout 60s;
        proxy_send_timeout 60s;
        proxy_read_timeout 60s;
    }

    # CORS –¥–ª—è API
    location ~* \.(json)$ {
        add_header Access-Control-Allow-Origin *;
    }

    # –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ —Å—Ç–∞—Ç–∏–∫–∏
    location ~* \.(css|js|jpg|jpeg|png|gif|ico|svg)$ {
        expires 1y;
        add_header Cache-Control "public, immutable";
    }

    # Gzip
    gzip on;
    gzip_types text/plain text/css application/json application/javascript;
}
```

### 9.4 –ê–∫—Ç–∏–≤–∞—Ü–∏—è –∫–æ–Ω—Ñ–∏–≥–∞ –∏ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞ Nginx

```bash
# –°–æ–∑–¥–∞—Ç—å —Å–∏–º–ª–∏–Ω–∫
sudo ln -s /etc/nginx/sites-available/greenhouse /etc/nginx/sites-enabled/

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é
sudo nginx -t

# –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç—å Nginx
sudo systemctl reload nginx
```

### 9.5 –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Firewall (–µ—Å–ª–∏ –≤–∫–ª—é—á–µ–Ω)

```bash
# UFW (Ubuntu)
sudo ufw allow 80/tcp
sudo ufw allow 443/tcp
sudo ufw allow 5678/tcp

# Firewalld (CentOS)
sudo firewall-cmd --permanent --add-port=80/tcp
sudo firewall-cmd --permanent --add-port=443/tcp
sudo firewall-cmd --permanent --add-port=5678/tcp
sudo firewall-cmd --reload
```

---

## üîí –®–∞–≥ 10: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ SSL (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ, –Ω–æ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

### –£—Å—Ç–∞–Ω–æ–≤–∫–∞ Certbot

```bash
# Ubuntu/Debian
sudo apt install certbot python3-certbot-nginx -y

# CentOS/RHEL
sudo yum install certbot python3-certbot-nginx -y
```

### –ü–æ–ª—É—á–µ–Ω–∏–µ SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞

```bash
sudo certbot --nginx -d –≤–∞—à-–¥–æ–º–µ–Ω.ru
```

–°–ª–µ–¥—É–π—Ç–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è–º. Certbot –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –Ω–∞—Å—Ç—Ä–æ–∏—Ç HTTPS.

---

## ‚úÖ –®–∞–≥ 11: –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏

### 11.1 –ü—Ä–æ–≤–µ—Ä–∫–∞ n8n

```bash
curl http://localhost:5678/healthcheck
```

–î–æ–ª–∂–µ–Ω –≤–µ—Ä–Ω—É—Ç—å: `{"status":"ok"}`

### 11.2 –ü—Ä–æ–≤–µ—Ä–∫–∞ Telegram –±–æ—Ç–∞

1. –û—Ç–∫—Ä–æ–π—Ç–µ Telegram
2. –ù–∞–π–¥–∏—Ç–µ –≤–∞—à–µ–≥–æ –±–æ—Ç–∞
3. –û—Ç–ø—Ä–∞–≤—å—Ç–µ `/start`
4. –ë–æ—Ç –¥–æ–ª–∂–µ–Ω –æ—Ç–≤–µ—Ç–∏—Ç—å

### 11.3 –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤–µ–±-–¥–∞—à–±–æ—Ä–¥–∞

–û—Ç–∫—Ä–æ–π—Ç–µ –±—Ä–∞—É–∑–µ—Ä:
```
http://–≤–∞—à-–¥–æ–º–µ–Ω.ru
```

–∏–ª–∏

```
http://–≤–∞—à-ip
```

–î–æ–ª–∂–µ–Ω –æ—Ç–∫—Ä—ã—Ç—å—Å—è –¥–∞—à–±–æ—Ä–¥ —Å –∫–∞—Ä—Ç–æ—á–∫–∞–º–∏ –∏ –≥—Ä–∞—Ñ–∏–∫–∞–º–∏.

### 11.4 –ü—Ä–æ–≤–µ—Ä–∫–∞ MQTT –¥–∞–Ω–Ω—ã—Ö

–í n8n:
1. –û—Ç–∫—Ä–æ–π—Ç–µ **Workflow: 01 - MQTT Data Pipeline**
2. –ù–∞–∂–º–∏—Ç–µ **Execute Workflow**
3. –ß–µ—Ä–µ–∑ ~30 —Å–µ–∫—É–Ω–¥ (–∫–æ–≥–¥–∞ ESP32 –æ—Ç–ø—Ä–∞–≤–∏—Ç –¥–∞–Ω–Ω—ã–µ) –¥–æ–ª–∂–Ω–∞ –ø–æ—è–≤–∏—Ç—å—Å—è –Ω–æ–≤–∞—è –∑–∞–ø–∏—Å—å

–ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ñ–∞–π–ª –¥–∞–Ω–Ω—ã—Ö:
```bash
cat ~/greenhouse-data/ugagro_readings.json | jq . | head -20
```

---

## üîç –®–∞–≥ 12: –õ–æ–≥–∏ –∏ –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

### n8n –ª–æ–≥–∏

```bash
# –ï—Å–ª–∏ —á–µ—Ä–µ–∑ systemd
sudo journalctl -u n8n -f

# –ï—Å–ª–∏ —á–µ—Ä–µ–∑ pm2
pm2 logs n8n

# –ï—Å–ª–∏ —á–µ—Ä–µ–∑ Docker
docker logs n8n -f
```

### Nginx –ª–æ–≥–∏

```bash
# Access log
sudo tail -f /var/log/nginx/greenhouse_access.log

# Error log
sudo tail -f /var/log/nginx/greenhouse_error.log
```

### –î–∞–Ω–Ω—ã–µ —Ç–µ–ø–ª–∏—Ü—ã

```bash
# –ü–æ—Å–ª–µ–¥–Ω–∏–µ –ø–æ–∫–∞–∑–∞–Ω–∏—è
tail -20 ~/greenhouse-data/ugagro_readings.json | jq .

# –°–æ—Å—Ç–æ—è–Ω–∏—è –æ–ø–æ–≤–µ—â–µ–Ω–∏–π
cat ~/greenhouse-data/telegram_alert_states.json | jq .

# –ò—Å—Ç–æ—Ä–∏—è –æ–ø–æ–≤–µ—â–µ–Ω–∏–π
tail -10 ~/greenhouse-data/ugagro_alerts_history.json | jq .
```

---

## üõ†Ô∏è –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –ù–µ–ø–æ–ª–∞–¥–æ–∫

### n8n –Ω–µ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è

```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å
sudo systemctl status n8n

# –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å
sudo systemctl restart n8n

# –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –ª–æ–≥–∏
sudo journalctl -u n8n -n 50
```

### Workflow –Ω–µ –∞–∫—Ç–∏–≤–∏—Ä—É–µ—Ç—Å—è

1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ credentials
2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –ø—É—Ç–∏ –∫ —Ñ–∞–π–ª–∞–º –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ n8n

### Telegram –±–æ—Ç –Ω–µ –æ—Ç–≤–µ—á–∞–µ—Ç

1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ `TELEGRAM_BOT_TOKEN` –≤ `.env`
2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –Ω–∞–ø–∏—Å–∞–ª–∏ –±–æ—Ç—É `/start`
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ workflow #2 –∞–∫—Ç–∏–≤–µ–Ω
4. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ n8n

### –î–∞—à–±–æ—Ä–¥ –Ω–µ –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è

```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å Nginx
sudo nginx -t
sudo systemctl status nginx

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ñ–∞–π–ª—ã
ls -la /var/www/greenhouse-dashboard/

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏
sudo tail -f /var/log/nginx/greenhouse_error.log
```

### –î–∞–Ω–Ω—ã–µ –Ω–µ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è

```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø—Ä–∞–≤–∞
ls -la ~/greenhouse-data/

# –î–æ–ª–∂–Ω–æ –±—ã—Ç—å -rw-rw-rw-
chmod 666 ~/greenhouse-data/*.json

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø—É—Ç—å –≤ workflows
# –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ø–æ–ª–Ω—ã–π –ø—É—Ç—å: /home/username/greenhouse-data/
```

---

## üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –û–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ

### –ï–∂–µ–¥–Ω–µ–≤–Ω—ã–µ –∑–∞–¥–∞—á–∏ (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ)

- ‚úÖ Workflow #5 –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ—á–∏—â–∞–µ—Ç —Å—Ç–∞—Ä—ã–µ –¥–∞–Ω–Ω—ã–µ –≤ 02:00
- ‚úÖ Workflow #2 –º–æ–Ω–∏—Ç–æ—Ä–∏—Ç –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∫–∞–∂–¥—ã–µ 20 —Å–µ–∫—É–Ω–¥
- ‚úÖ Telegram —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –ø—Ä–∏—Ö–æ–¥—è—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏

### –ï–∂–µ–Ω–µ–¥–µ–ª—å–Ω—ã–µ –∑–∞–¥–∞—á–∏ (–≤—Ä—É—á–Ω—É—é)

```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–∞–∑–º–µ—Ä —Ñ–∞–π–ª–æ–≤ –¥–∞–Ω–Ω—ã—Ö
du -sh ~/greenhouse-data/*

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏ Nginx
sudo du -sh /var/log/nginx/*

# –û—á–∏—Å—Ç–∏—Ç—å —Å—Ç–∞—Ä—ã–µ –ª–æ–≥–∏ (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ)
sudo logrotate -f /etc/logrotate.conf
```

### –ï–∂–µ–º–µ—Å—è—á–Ω—ã–µ –∑–∞–¥–∞—á–∏

```bash
# –û–±–Ω–æ–≤–∏—Ç—å —Å–∏—Å—Ç–µ–º—É
sudo apt update && sudo apt upgrade -y

# –û–±–Ω–æ–≤–∏—Ç—å n8n (–µ—Å–ª–∏ —á–µ—Ä–µ–∑ npm)
npm update -g n8n

# –û–±–Ω–æ–≤–∏—Ç—å workflows (–µ—Å–ª–∏ –±—ã–ª–∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏)
cd ~/Balagan
git pull
# –ó–∞—Ç–µ–º –ø–µ—Ä–µ–∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å workflows –≤ UI
```

---

## üéØ –°–ª–µ–¥—É—é—â–∏–µ –®–∞–≥–∏

1. ‚úÖ –ù–∞—Å—Ç—Ä–æ–∏—Ç—å DNS –¥–ª—è –¥–æ–º–µ–Ω–∞ (–µ—Å–ª–∏ –µ—â–µ –Ω–µ —Å–¥–µ–ª–∞–Ω–æ)
2. ‚úÖ –ù–∞—Å—Ç—Ä–æ–∏—Ç—å SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç (–®–∞–≥ 10)
3. ‚úÖ –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π backup –¥–∞–Ω–Ω—ã—Ö
4. ‚úÖ –î–æ–±–∞–≤–∏—Ç—å –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ Telegram –∫–æ–º–∞–Ω–¥—ã (–ø–æ –∂–µ–ª–∞–Ω–∏—é)
5. ‚úÖ –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å —Å Grafana (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

---

## üìû –ü–æ–¥–¥–µ—Ä–∂–∫–∞

**–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è:**
- [README.md](../README.md) - –ø–æ–ª–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
- [QUICK_START.md](QUICK_START.md) - –±—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç
- [MQTT_DATA_STRUCTURE.md](MQTT_DATA_STRUCTURE.md) - —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö

**Beget Support:**
- https://beget.com/ru/kb
- –¢–∏–∫–µ—Ç—ã –≤ –ø–∞–Ω–µ–ª–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è

**GitHub Issues:**
- https://github.com/Daydyaefim/Balagan/issues

---

## ‚úÖ Checklist –†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è

- [ ] n8n —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞ —á–µ—Ä–µ–∑ Beget Marketplace
- [ ] SSH –¥–æ—Å—Ç—É–ø –Ω–∞—Å—Ç—Ä–æ–µ–Ω
- [ ] –î–∏—Ä–µ–∫—Ç–æ—Ä–∏—è `/home/username/greenhouse-data/` —Å–æ–∑–¥–∞–Ω–∞
- [ ] –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –¥–æ–±–∞–≤–ª–µ–Ω—ã –≤ `.env`
- [ ] n8n –ø–µ—Ä–µ–∑–∞–ø—É—â–µ–Ω–∞
- [ ] 5 workflows –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω—ã
- [ ] MQTT credentials –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã
- [ ] Telegram credentials –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã
- [ ] –ü—É—Ç–∏ –∫ —Ñ–∞–π–ª–∞–º –æ–±–Ω–æ–≤–ª–µ–Ω—ã –≤ workflows
- [ ] –í—Å–µ workflows –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω—ã
- [ ] Nginx —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –∏ –Ω–∞—Å—Ç—Ä–æ–µ–Ω
- [ ] –í–µ–±-–¥–∞—à–±–æ—Ä–¥ —Ä–∞–∑–≤–µ—Ä–Ω—É—Ç
- [ ] SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
- [ ] Firewall –Ω–∞—Å—Ç—Ä–æ–µ–Ω
- [ ] Telegram –±–æ—Ç –æ—Ç–≤–µ—á–∞–µ—Ç
- [ ] –í–µ–±-–¥–∞—à–±–æ—Ä–¥ –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è
- [ ] MQTT –¥–∞–Ω–Ω—ã–µ –ø–æ—Å—Ç—É–ø–∞—é—Ç

---

**üéâ –ü–æ–∑–¥—Ä–∞–≤–ª—è–µ–º! –í–∞—à–∞ —Å–∏—Å—Ç–µ–º–∞ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ —Ç–µ–ø–ª–∏—Ü—ã —Ä–∞–∑–≤–µ—Ä–Ω—É—Ç–∞ –Ω–∞ Beget VPS!**
