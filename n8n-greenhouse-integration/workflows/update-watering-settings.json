{
  "name": "UPDATE Watering Settings - –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∑–Ω–∞—á–µ–Ω–∏–π",
  "nodes": [
    {
      "parameters": {},
      "id": "manual-trigger",
      "name": "–ó–∞–ø—É—Å—Ç–∏—Ç—å –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ",
      "type": "n8n-nodes-base.manualTrigger",
      "typeVersion": 1,
      "position": [240, 300]
    },
    {
      "parameters": {
        "operation": "executeQuery",
        "query": "-- –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –Ω–∞—Å—Ç—Ä–æ–µ–∫ –ø–æ–ª–∏–≤–∞ –¥–æ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π\nUPDATE watering_settings\nSET\n    rad_threshold = 1.1,\n    watering_duration_sec = 200,\n    max_interval_minutes = 90,\n    watering_window_start = '07:40:00',\n    watering_window_end = '17:20:00',\n    morning_start_time = '07:40:00',\n    updated_at = NOW()\nWHERE id = 1;\n\n-- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç\nSELECT\n    '–û–±–Ω–æ–≤–ª–µ–Ω–æ —É—Å–ø–µ—à–Ω–æ' as status,\n    rad_threshold,\n    watering_duration_sec,\n    max_interval_minutes,\n    watering_window_start,\n    watering_window_end,\n    morning_start_time,\n    updated_at\nFROM watering_settings\nWHERE id = 1;",
        "options": {}
      },
      "id": "update-settings",
      "name": "–û–±–Ω–æ–≤–∏—Ç—å –ù–∞—Å—Ç—Ä–æ–π–∫–∏",
      "type": "n8n-nodes-base.postgres",
      "typeVersion": 2.4,
      "position": [460, 300],
      "credentials": {
        "postgres": {
          "id": "greenhouse_db",
          "name": "Greenhouse PostgreSQL"
        }
      }
    },
    {
      "parameters": {
        "jsCode": "const result = $input.first().json;\n\nconst message = `‚úÖ *–ù–ê–°–¢–†–û–ô–ö–ò –ü–û–õ–ò–í–ê –û–ë–ù–û–í–õ–ï–ù–´*\\n\\nüìä *–ù–æ–≤—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è:*\\n\\nüéØ *–ü–æ—Ä–æ–≥ —Ä–∞–¥–∏–∞—Ü–∏–∏:* ${result.rad_threshold} –ú–î–∂/–º¬≤\\n‚è±Ô∏è *–î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –ø–æ–ª–∏–≤–∞:* ${result.watering_duration_sec} —Å–µ–∫\\n‚è≥ *–ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π –∏–Ω—Ç–µ—Ä–≤–∞–ª:* ${result.max_interval_minutes} –º–∏–Ω (${Math.floor(result.max_interval_minutes / 60)}—á ${result.max_interval_minutes % 60}–º–∏–Ω)\\nüïê *–û–∫–Ω–æ –ø–æ–ª–∏–≤–æ–≤:* ${result.watering_window_start.substring(0, 5)} - ${result.watering_window_end.substring(0, 5)}\\nüåÖ *–£—Ç—Ä–µ–Ω–Ω–∏–π –ø–æ–ª–∏–≤:* ${result.morning_start_time.substring(0, 5)}\\n\\nüïí *–û–±–Ω–æ–≤–ª–µ–Ω–æ:* ${new Date(result.updated_at).toLocaleString('ru-RU')}\\n\\n‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\\n\\n‚ú® –ù–∞—Å—Ç—Ä–æ–π–∫–∏ —É—Å–ø–µ—à–Ω–æ –ø—Ä–∏–º–µ–Ω–µ–Ω—ã!`;\n\nconsole.log(message);\n\nreturn [{ json: { ...result, message, success: true } }];"
      },
      "id": "format-result",
      "name": "–§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞—Ç—å –†–µ–∑—É–ª—å—Ç–∞—Ç",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [680, 300]
    }
  ],
  "connections": {
    "–ó–∞–ø—É—Å—Ç–∏—Ç—å –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ": {
      "main": [
        [
          {
            "node": "–û–±–Ω–æ–≤–∏—Ç—å –ù–∞—Å—Ç—Ä–æ–π–∫–∏",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "–û–±–Ω–æ–≤–∏—Ç—å –ù–∞—Å—Ç—Ä–æ–π–∫–∏": {
      "main": [
        [
          {
            "node": "–§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞—Ç—å –†–µ–∑—É–ª—å—Ç–∞—Ç",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  },
  "pinData": {},
  "settings": {
    "executionOrder": "v1"
  },
  "staticData": null,
  "tags": [],
  "triggerCount": 0,
  "updatedAt": "2025-01-19T09:20:00.000Z",
  "versionId": "1"
}
